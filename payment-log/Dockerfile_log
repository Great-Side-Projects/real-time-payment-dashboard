FROM openjdk:22-jdk-slim

ARG DATASOURCE_URL
ARG DATASOURCE_USERNAME
ARG DATASOURCE_PASSWORD
ARG RABBITMQ_HOST
ARG RABBITMQ_PORT
ARG RABBITMQ_USERNAME
ARG RABBITMQ_PASSWORD

WORKDIR /app

COPY target/*.jar /app/payment-log.jar

EXPOSE 8082

ENV SPRING_DATASOURCE_URL=${DATASOURCE_URL} \
    SPRING_DATASOURCE_USERNAME=${DATASOURCE_USERNAME} \
    SPRING_DATASOURCE_PASSWORD=${DATASOURCE_PASSWORD} \
    SPRING_RABBITMQ_HOST=${RABBITMQ_HOST} \
    SPRING_RABBITMQ_PORT=${RABBITMQ_PORT} \
    SPRING_RABBITMQ_USERNAME=${RABBITMQ_USERNAME} \
    SPRING_RABBITMQ_PASSWORD=${RABBITMQ_PASSWORD}

ENTRYPOINT ["java", "-jar", "payment-log.jar"]