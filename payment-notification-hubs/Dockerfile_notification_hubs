FROM openjdk:22-jdk-slim

ARG KAFKA_BOOTSTRAP_SERVERS
ARG KAFKA_PROPERTIES_SASL_JAAS_CONFIG
ARG RABBITMQ_HOST
ARG RABBITMQ_PORT
ARG RABBITMQ_USERNAME
ARG RABBITMQ_PASSWORD

WORKDIR /app

COPY target/*.jar /app/payment-notification-hub.jar

EXPOSE 8083

ENV SPRING_KAFKA_BOOTSTRAP_SERVERS=${KAFKA_BOOTSTRAP_SERVERS} \
    SPRING_KAFKA_PROPERTIES_SASL_JAAS_CONFIG="${KAFKA_PROPERTIES_SASL_JAAS_CONFIG}" \
    SPRING_RABBITMQ_HOST=${RABBITMQ_HOST} \
    SPRING_RABBITMQ_PORT=${RABBITMQ_PORT} \
    SPRING_RABBITMQ_USERNAME=${RABBITMQ_USERNAME} \
    SPRING_RABBITMQ_PASSWORD=${RABBITMQ_PASSWORD}

ENTRYPOINT ["java", "-jar", "payment-notification-hub.jar"]